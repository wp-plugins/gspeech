(function($){$(document).ready(function(){function check_pro_version_by_class(){if($(".gspeech_wrapper").is(":visible"))return true;return false};$('.greeting_block').each(function(i){if(i>1){$(this).next('.sound_container_pro').remove();$(this).prev('.gspeech_selection').remove()}});$('.sound_container_pro').each(function(i){$elem=$(this);var a=$(this).attr("autoplaypro");var b=$(this).attr("speechtimeout");if(isNaN(b))b=0;b=parseInt(b);var c=$(this).attr("selector");var d=$(this).attr("eventpro");if(c!=''&&d!=''&&createtriggerspeechcount<1){createtriggerspeech($elem,b,c,d);createtriggerspeechcount++}else if(a==1){triggerspeech($elem,b)}});function triggerspeech(a,b){speechtimeoutfinal=speechtimeoutfinal+b*1+200*1;setTimeout(function(){stop_all_speakers_pro($('.sound_container_pro'));clearAllPlayers();setTimeout(function(){make_speeching(a)},10)},speechtimeoutfinal)};function createtriggerspeech(e,f,g,h){$(""+g+"").bind(h,function(){var a=$(this);var b=a.html().replace(/<\/?[^>]+>/gi,'');var c=a.val().replace(/<\/?[^>]+>/gi,'');stop_all_speakers_pro($('.sound_container_pro'));clearAllPlayers();var d=e.children('.sound_text_pro').html();if(d=='gspeech_html'||e.children('.sound_text_pro').attr("htm")=='gspeech_html'){e.children('.sound_text_pro').attr("htm","gspeech_html");e.children('.sound_text_pro').html(b)}else if(d=='gspeech_value'||e.children('.sound_text_pro').attr("htm")=='gspeech_value'){e.children('.sound_text_pro').attr("htm","gspeech_value");e.children('.sound_text_pro').html(c)}setTimeout(function(){make_speeching(e)},f)})};var o=1;$('.sound_container_position').each(function(i){$this=$(this);if($(this).hasClass("greeting_block"))++o;if(i<o){setTimeout(function(){var a=$this.position();var b=a.left;var c=a.top;$this.next('.sound_container_pro').css({top:c,left:b,display:'block'});$this.prev('span').prev('.gspeech_wrapper').css({top:c+43*1,left:b,display:'block'})},300)}else{$(this).next('.sound_container_pro').remove()}});$('.sound_container_pro').hover(function(){var a=$(this).prev('.sound_container_position').prev('.gspeech_selection');var b=a.attr("roll");b=b==''?1:b;--b;var c=parseFloat(gspeech_animation_time[b]);var d=parseInt(gspeech_spoa[b]/100);$(this).stop().animate({opacity:d},c);a.stop().animate({backgroundColor:gspeech_bca[b],color:gspeech_ca[b]},c)},function(){var a=$(this).prev('.sound_container_position').prev('.gspeech_selection');var b=a.attr("roll");b=b==''?1:b;--b;if(!$(this).hasClass('active')){var c=parseInt(gspeech_animation_time[b]);var d=parseFloat(gspeech_spop[b]/100);$(this).stop().animate({opacity:d},c)};if(!a.hasClass('active')){a.stop().animate({backgroundColor:gspeech_bcp[b],color:gspeech_cp[b]},c)}});$('.sound_container_pro').mousedown(function(){pro_container_clicked=true;basic_plg_enable=false});$("body").mousedown(function(){if($('.sound_container_pro.active').length>0&&!pro_container_clicked)basic_plg_enable=true;stop_all_speakers_pro($('.sound_container_pro'));clearAllPlayers();$('.sound_container_pro').removeClass('active');$('.gspeech_selection').removeClass('active')});$('.sound_container_pro').click(function(){if(!check_pro_version_by_class()){alert('To hide a backlink please purchase a GSpeech PRO version');return false}make_speeching($(this))});function make_speeching(a){var b=a.children('.sound_text_pro').html();if(speechtxt!=b){var c=a.prev('.sound_container_position').prev('.gspeech_selection');c.stop().removeAttr("style").addClass('active');a.addClass('active');var d=a.attr("language");d=d==''?lang_identifier:d;blinking_enable_pro=true;blink_start_enable_pro=true;var e=a.attr("roll");e=e==''?1:e;--e;var f=parseFloat(gspeech_spoa[e]/100);a.stop().fadeTo(400,f);rotate_speaker_pro(a);clearAllPlayers();make_audio_pro(a.children('.sound_text_pro'),a,d)}speechtxt=b;setTimeout(function(){speechtxt=''},100)};function stop_speaker_pro(a){basic_plg_enable=true;clearAllPlayers();a.rotate({animateTo:360});var b=a.attr("roll");b=b==''?1:b;--b;var c=parseFloat(gspeech_spop[b]/100);a.stop().fadeTo(400,c).removeClass('active');for(f in blink_timer){clearTimeout(blink_timer[f])}for(f in rotate_timer){clearInterval(rotate_timer[f])}};function stop_all_speakers_pro(a){clearAllPlayers();$('.sound_container_pro.active').rotate({animateTo:360});var b=a.attr("roll");b=b==''?1:b;--b;var c=parseFloat(gspeech_spop[b]/100);a.stop().fadeTo(400,c).removeClass('active');for(f in blink_timer){clearTimeout(blink_timer[f])}for(f in rotate_timer){clearInterval(rotate_timer[f])}};function rotate_speaker_pro(a){var b=0;rotate_timer_element=setInterval(function(){b+=3;a.rotate(b)},15);rotate_timer.push(rotate_timer_element)};function blink_speaker_pro(a){if(blink_start_enable_pro){a.fadeTo(200,0.2);blink_start_enable_pro=false}else{a.fadeTo(200,1);blink_start_enable_pro=true}var t=setTimeout(function(){blink_speaker_pro(a)},800);blink_timer.push(t)};function change_speaker_animation_pro(a){if(blinking_enable_pro){for(f in rotate_timer){clearInterval(rotate_timer[f])}a.rotate({animateTo:0});blink_speaker_pro(a)}blinking_enable_pro=false};function make_audio_pro(g,h,j){selected_txt=g.html();var k=new Array(),sent_array=new Array(),sent_index=0;k=selected_txt.split(/[^\S]+/);for(var i=0;i<k.length;i++){if(sent_array[sent_index]==undefined){sent_array[sent_index]=''}var l=sent_array[sent_index].length+k[i].length;if(sent_array[sent_index].length<speech_text_length&&l<speech_text_length){sent_array[sent_index]+=k[i]+' '}else{++sent_index;sent_array[sent_index]=k[i]+' '}};var m=sent_array.length;var n='';for(var i=0;i<m;i++){n+='<audio id="player'+i+'" src="'+streamerphp_folder+'gspeech.mpeg" type="'+translation_audio_type+'" controls="controls"></audio>'};$("#sound_audio").html(n);for(var i=0;i<m;i++){create_htm(i,m)};function create_htm(i,f){$('#player'+i).mediaelementplayer({success:function(a,b){players[i]=a;var c=encodeURIComponent(sent_array[i]);var d=streamerphp_folder+'streamer.php?q='+c+'&l='+j+'&tr_tool='+translation_tool;a.setSrc(d);a.addEventListener('pause',function(e){try{players[i+1].play()}catch(e){}},false);players[0].addEventListener('progress',function(e){change_speaker_animation_pro(h)},false);if(i==f-1){players[f-1].addEventListener('pause',function(e){stop_speaker_pro(h)},false)}a.load();if(i==0){a.play()}}})}};function clearAllPlayers(){for(var c in players){players[c]=''}$('#sound_audio').html('')}})})(jQuery);